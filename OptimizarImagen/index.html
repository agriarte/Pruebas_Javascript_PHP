
<!doctype html>
<html lang="en"><head>
        <title>Javascript Image Compress using HTML5 Canvas & File API before Upload | PHPLift.net</title>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <style type="text/css">

            img {border-width: 0}
            * {font-family:'Lucida Grande', sans-serif;}

            .block a:hover{
                color: silver;
            }
            .block a{
                color: #fff;
            }
            .block {
                position: fixed;
                background: #2184cd;
                padding: 20px;
                z-index: 1;
                top: 240px;
            }

        </style>

        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-6883622550208397",
                enable_page_level_ads: true
            });
        </script>

    </head>
    <body  >

        <div class="block">
            <a href="http://www.phplift.net/javascript-image-compress-using-html5-canvas-file-api-before-upload/">Bact to Tutorial</a>
        </div>


        <div>
            <h2>Javascript Image Compress using HTML5 Canvas & File API before Upload Example&nbsp;&nbsp;&nbsp;=> <a href="http://www.phplift.net/">Home</a> | <a href="https://demos.phplift.net/">More Demos</a></h2>



            <div style="margin-top:8px">
                <iframe allowtransparency="true" frameborder="0" scrolling="no" src="https://platform.twitter.com/widgets/follow_button.1354093195.html#_=1354256562997&amp;id=twitter-widget-8&amp;lang=en&amp;screen_name=PHPLift&amp;show_count=true&amp;show_screen_name=true&amp;size=m" class="twitter-follow-button" style="width: 256px; height: 20px;" title="Twitter Follow Button" data-twttr-rendered="true"></iframe>
            </div>
            <div style="float:left;width:90px">
                <a href="https://feeds2.feedburner.com/PHPLift" title="PHPLift feed"><img alt="feed" height="26" src="https://feeds2.feedburner.com/~fc/PHPLift1?bg=f2a0bb&amp;fg=000000&amp;anim=0&amp;label=Readers" style="border:0;margin-right:10px;margin-top:6px" width="88"></a>
            </div>
            <div style="float:left;width:120px;margin-left:20px;margin-top:2px">
                <iframe allowtransparency="true" frameborder="0" scrolling="no" src="//www.facebook.com/plugins/subscribe.php?href=https%3A%2F%2Fwww.facebook.com%2Fhuzoorbux&amp;layout=button_count&amp;show_faces=true&amp;colorscheme=light&amp;font&amp;width=200&amp;appId=206841902768508" style="border:none; overflow:hidden; width:160px;height:25px;margin-top:5px"></iframe>
            </div>
            <!-- Place this tag where you want the badge to render. -->

            <div style="text-align: center;">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- PHPGang top demo all pages2 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:728px;height:300px"
                     data-ad-client="ca-pub-6883622550208397"
                     data-ad-slot="8876576507"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>

            <br /><br />
            <hr />

            <p>
                <link href="https://getbootstrap.com/docs/4.3/dist/css/bootstrap.min.css" rel="stylesheet">
            <div class="container">
                <div class="row">
                    <div class="col-md-4 border">
                        <form id="upload_form">
                            <label for="file">Choose file</label>
                            <input type="file" id="fileinput" />

                        </form>
                    </div>
                    <div class="col-md-4 border">
                        <div class="thumbnail">
                            <img id="source_image"  style="width:100%">
                            <div class="caption">
                                <p>Source Image</p>
                                <p><input type="button" id="compress" value="Compress" class="btn-primary" style="display: none;"></p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 border">
                        <div class="thumbnail">
                            <img id="compressed_image"  style="width:100%">
                            <div class="caption">
                                <p>Compressed Image</p>
                                <p><input type="button" id="upload" class="btn-success" value="Upload" style="display: none;"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
            <script src="JIC.js"></script>

            <script>
                var output_format = null;
                var file_name = null;
                function readFile(evt) {
                    var file = evt.target.files[0];
                    var reader = new FileReader();
                    reader.onload = function (event) {
                        var i = document.getElementById("source_image");
                        console.log(i);
                        i.src = event.target.result;
                        i.onload = function () {

                            console.log("Image loaded");
                        }
                    };
                    output_format = file.name.split(".").pop();
                    file_name = file.name;
                    console.log("Filename:" + file.name);
                    console.log("Fileformat:" + output_format);
                    console.log("Filesize:" + (parseInt(file.size) / 1024) + " Kb");
                    console.log("Type:" + file.type);
                    reader.readAsDataURL(file);
                    $("#compress").show();
                    return false;
                }
                // compress image
                $("#compress").click(function () {
                    var source_image = document.getElementById("source_image");
                    if (source_image.src == "") {
                        alert("You must load an image first!");
                        return false;
                    }

                    var quality = 30;

                    console.log("process start...");
                    console.log("process start compress ...");
                    compressed_image.src = jic.compress(source_image, quality, output_format).src;
                    $("#upload").show();

                });
                // upload imange
                $("#upload").click(function () {
                    var compressed_image = document.getElementById("compressed_image");
                    if (compressed_image.src == "") {
                        alert("You must compress image first!");
                        return false;
                    }

                    var successCallback = function (response) {
                        console.log("image uploaded successfully! :)");
                        console.log(response);
                    }

                    var errorCallback = function (response) {
                        console.log("image Filed to upload! :)");
                        console.log(response);
                    }

                    console.log("process start upload ...");
                    jic.upload(compressed_image, "upload.php", "file", file_name, successCallback, errorCallback);

                });

                document.getElementById("fileinput").addEventListener("change", readFile, false);
            </script>                   
            <div style='margin-left: auto;margin-right: auto;text-align: center;'>
                <br /><hr /><br /></div>

           


    </body>
</html>